//
//  jailbreak.m
//  kfund
//
//  Created by Seo Hyun-gyu on 1/2/24.
//

#import "jailbreak.h"
#import "../ViewController.h"
#import "krw.h"

void printlog_kfd_info(void) {
    print_log("current_proc = 0x%llx", get_selfproc());
    print_log("current_task = 0x%llx", get_selftask());
    print_log("current_pmap = 0x%llx", get_selfpmap());
    print_log("kernel_proc = 0x%llx", get_kernproc());
    print_log("kernel_task = 0x%llx", get_kerntask());
    print_log("kernel_pmap = 0x%llx", get_kernpmap());
    print_log("kernel_base = 0x%llx", get_kernbase());
    print_log("kernel_slide = 0x%llx", get_kslide());
}

int start_jailbreak(void) {
    print_log("Running smith kexploit...");
    do_kopen(0x800, 1, 2, 2);
    
    printlog_kfd_info();
    
    
    do_kclose();
    
    return 0;
}

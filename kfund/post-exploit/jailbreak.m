//
//  jailbreak.m
//  kfund
//
//  Created by Seo Hyun-gyu on 1/2/24.
//

#import "jailbreak.h"
#import "../libkfd/libkfd.h"
#import "../ViewController.h"

void printlog_kfd_info(struct kfd *_kfd) {
    print_log("current_proc = 0x%llx", _kfd->info.kernel.current_proc);
    print_log("current_task = 0x%llx", _kfd->info.kernel.current_task);
    print_log("fcurrent_map = 0x%llx", _kfd->info.kernel.current_map);
    print_log("current_pmap = 0x%llx", _kfd->info.kernel.current_pmap);
    print_log("kernel_proc = 0x%llx", _kfd->info.kernel.kernel_proc);
    print_log("kernel_task = 0x%llx", _kfd->info.kernel.kernel_task);
    print_log("kernel_map = 0x%llx", _kfd->info.kernel.kernel_map);
    print_log("kernel_pmap = 0x%llx", _kfd->info.kernel.kernel_pmap);
}

int start_jailbreak(void) {
    print_log("Running smith kexploit...");
    struct kfd *_kfd = kopen(0x800, 1, 2, 2);
    printlog_kfd_info(_kfd);
    
    kclose(_kfd);
    
    return 0;
}
